<!-- component -->
<!-- This is an example component -->
<div class="container mx-auto shadow-lg rounded-lg">
  <!-- header -->
  <div class="px-5 py-5 flex justify-between items-center bg-white border-b-2">
    <div class="flex items-center gap-3">
      <img src="images/logo.jpg" alt="ChinaGO Logo" class="w-10 h-10 rounded shadow" />
      <span class="font-semibold text-2xl text-red-600">Soporte ChinaGO</span>
    </div>
    <div class="h-12 w-12 p-2 bg-red-600 rounded-full text-white font-semibold flex items-center justify-center" title="Agente">
      AG
    </div>
  </div>
  <!-- end header -->
  <div class="fixed inset-0 z-50 bg-white flex flex-row">
    <!-- Lista de tickets activos -->
    <aside class="w-72 bg-gray-100 border-r flex-shrink-0 h-full">
      <h2 class="text-lg font-bold p-4 border-b">Chats activos</h2>
      <ul>
        <!-- Simulación de tickets, reemplaza por *ngFor="let ticket of tickets" en Angular real -->
        <li
          *ngFor="let ticket of tickets"
          (click)="seleccionarTicket(ticket)"
          [class.bg-red-100]="ticket.id === ticketSeleccionado?.id"
          class="cursor-pointer p-3 border-b hover:bg-red-50 flex flex-col"
        >
          <span class="font-semibold text-red-700">#{{ ticket.numero }}</span>
          <span class="text-gray-700">{{ ticket.nombre }}</span>
        </li>
        <!-- Ejemplo estático si no tienes lógica Angular:
        <li class="cursor-pointer p-3 border-b hover:bg-red-50 flex flex-col bg-red-100">
          <span class="font-semibold text-red-700">#12345</span>
          <span class="text-gray-700">Juan Pérez</span>
        </li>
        <li class="cursor-pointer p-3 border-b hover:bg-red-50 flex flex-col">
          <span class="font-semibold text-red-700">#12346</span>
          <span class="text-gray-700">Ana Gómez</span>
        </li>
        -->
      </ul>
    </aside>
    <!-- Chat del ticket seleccionado + info usuario a la derecha -->
    <div class="flex-1 flex flex-row h-full">
      <div class="flex-1 flex flex-col h-full">
        <ng-container *ngIf="ticketSeleccionado; else seleccionaTicket">
          <!-- Chatting inline, con mensajes dinámicos y animaciones -->
          <div class="w-full px-5 flex flex-col justify-between h-full">
            <div #mensajesContainer class="flex flex-col mt-5 space-y-4 flex-1 overflow-y-auto">
              <div *ngFor="let mensaje of mensajes; let i = index">
                <div 
                  [ngClass]="mensaje.esUsuario ? 'flex justify-end' : 'flex justify-start'"
                  [class.mensaje-fade-in]="true"
                >
                  <ng-container *ngIf="!mensaje.esUsuario; else agenteMsg">
                    <!-- Mensaje recibido (usuario) a la izquierda -->
                    <img src="https://ui-avatars.com/api/?name=Usuario&background=cccccc&color=222222" class="object-cover h-8 w-8 rounded-full mr-2" alt="Usuario" />
                    <div 
                      class="py-3 px-4 bg-gray-200 text-gray-900 rounded-br-3xl rounded-tr-3xl rounded-tl-xl max-w-lg"
                    >
                      {{ mensaje.texto }}
                    </div>
                  </ng-container>
                  <ng-template #agenteMsg>
                    <!-- Mensaje enviado (agente) a la derecha -->
                    <div 
                      class="py-3 px-4 bg-red-600 text-white rounded-bl-3xl rounded-tl-3xl rounded-tr-xl max-w-lg"
                    >
                      {{ mensaje.texto }}
                    </div>
                    <img src="images/logo.jpg" class="object-cover h-8 w-8 rounded-full ml-2" alt="Agente" />
                  </ng-template>
                </div>
              </div>
            </div>
            <!-- Input para el agente -->
            <form class="py-5 flex items-center gap-2" (submit)="enviarMensaje($event)">
              <input
                class="w-full bg-gray-200 py-4 px-4 rounded-xl border border-gray-300 focus:border-red-600 focus:ring-2 focus:ring-red-200 transition"
                type="text"
                [(ngModel)]="mensajeUsuario"
                name="mensajeUsuario"
                placeholder="Escribe tu respuesta al usuario..."
                autocomplete="off"
              />
              <button type="submit" class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-xl font-semibold shadow transition">
                Enviar
              </button>
            </form>
          </div>
        </ng-container>
        <ng-template #seleccionaTicket>
          <div class="flex-1 flex items-center justify-center text-gray-500">
            Selecciona un ticket para comenzar el chat.
          </div>
        </ng-template>
      </div>
      <!-- Panel lateral con info del usuario a la derecha -->
      <div class="w-2/5 border-l-2 px-5 hidden lg:block h-full" *ngIf="ticketSeleccionado">
        <div class="flex flex-col">
          <div class="font-semibold text-xl py-4">Información del usuario</div>
          <img src="https://ui-avatars.com/api/?name=Usuario&background=cccccc&color=222222" class="object-cover rounded-xl h-40 w-40 mx-auto mb-4" alt="Usuario" />
          <div class="font-semibold">Nombre:</div>
          <div class="mb-2">{{ ticketSeleccionado?.nombre }}</div>
          <div class="font-semibold">Ticket:</div>
          <div class="mb-2">#{{ ticketSeleccionado?.numero }}</div>
          <div class="font-semibold">Email:</div>
          <div class="mb-2">{{ ticketSeleccionado?.email }}</div>
          <div class="font-semibold">Última consulta:</div>
          <div class="mb-2">{{ ticketSeleccionado?.ultimaConsulta }}</div>
          <div class="font-light mt-4 text-gray-500 text-sm">
            Este chat fue derivado automáticamente por el bot. Puedes continuar la atención personalizada aquí.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Animaciones para los mensajes -->
<style>
.mensaje-fade-in {
  animation: mensajeFadeIn 0.3s cubic-bezier(0.4,0,0.2,1);
  animation-fill-mode: both;
}
@keyframes mensajeFadeIn {
  from { opacity: 0; transform: translateY(20px);}
  to { opacity: 1; transform: translateY(0);}
}
</style>
